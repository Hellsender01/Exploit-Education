#!/usr/bin/python3

from pwn import *
from sys import argv,exit

if len(argv) < 2:
	sys.exit("Target IP Missing") 

level14 = ssh(host=argv[1],user='level14',password='level14')
encrypted_token = (level14.download_data('/home/flag14/token')).decode()
decrypted_token = ""

for i in range(len(encrypted_token)):
	try:
		character = chr(ord(encrypted_token[i])-i)
		decrypted_token += character
	except:
		pass

level14.close()

log.success(f'Got flag14 password : {decrypted_token}')

flag14 = ssh(host=argv[1],user='flag14',password=decrypted_token[:-1])
flag14_shell = flag14.shell('sh')
flag14_shell.sendline("getflag")
flag14_shell.interactive(prompt="")